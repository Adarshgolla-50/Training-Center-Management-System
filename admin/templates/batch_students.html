{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('admin.courses') }}">Courses</a></li>
            <li class="breadcrumb-item"><a href="{{ url_for('admin.course_batches', course_id=batch.course_id) }}">{{ batch.course_name }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ batch.batch_name }}</li>
        </ol>
    </nav>

    <h2 class="mb-4">Students in {{ batch.batch_name }}</h2>

    <!-- Add Student Button -->
    <div class="mb-3">
        <a href="{{ url_for('admin.add_student', batch_id=batch.batch_id) }}" class="btn btn-success">Enroll New Student</a>
    </div>

    {% if students %}
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>#</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Guardian</th>
                        <th>DOB</th>
                        <th>Enrollment Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>{{ student.full_name }}</td>
                        <td>{{ student.email }}</td>
                        <td>{{ student.phone }}</td>
                        <td>{{ student.guardian_name or '-' }}</td>
                        <td>{{ student.dob.strftime('%d-%m-%Y') if student.dob else '-' }}</td>
                        <td>{{ student.enrollment_date.strftime('%d-%m-%Y') if student.enrollment_date else '-' }}</td>
                        <td>
                            {% if student.is_active %}
                                <span class="badge bg-success">Active</span>
                            {% else %}
                                <span class="badge bg-danger">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{{ url_for('admin.edit_student', student_id=student.student_id) }}" class="btn btn-sm btn-warning">Edit</a>
                            <a href="{{ url_for('admin.delete_student', student_id=student.student_id) }}" 
                               class="btn btn-sm btn-danger" 
                               onclick="return confirm('Are you sure you want to delete this student?');">
                               Delete
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="text-center py-4">
            <h5>No students enrolled in this batch yet.</h5>
        </div>
    {% endif %}
</div>
{% endblock %}
