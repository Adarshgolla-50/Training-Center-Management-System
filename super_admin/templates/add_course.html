{% extends "base.html" %}

{% block content %}

<div class="row">
    <div class="col-md-12 grid-margin">
        <div class="row">
            <div class="col-12 col-xl-8 mb-4 mb-xl-0">
                <h3 class="font-weight-bold">Course Management</h3>
                <h6 class="font-weight-normal mb-0">Add a new course</h6>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Add New Course</h4>

                <!-- Success message -->
                <div id="success_message" class="alert alert-success d-none" tabindex="-1"></div>

                <form id="add-course-form" class="forms-sample">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="course_name">Course Name<span style="color:red">*</span></label>
                                <input type="text" class="form-control" id="course_name" name="course_name"
                                    placeholder="Course Name" required>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="is_active">Active</label>
                                <select class="form-control" id="is_active" name="is_active">
                                    <option value="1" selected>Active</option>
                                    <option value="0">Inactive</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group mt-3">
                        <label for="description">Description</label>
                        <textarea class="form-control" id="description" name="description" placeholder="Description"
                            rows="6" style="line-height: 1.5; letter-spacing: 0.5px; padding: 0.5rem;height:150px"></textarea>
                    </div>

                    <button type="submit" class="btn btn-primary me-2 mt-3">Save Course</button>
                    <button type="reset" class="btn btn-light mt-3">Cancel</button>
                </form>

            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("add-course-form");
    const successMessage = document.getElementById("success_message");

    form.addEventListener("submit", function (e) {
        e.preventDefault();
        const formData = new FormData(form);

        fetch(form.action, {
            method: "POST",
            body: formData
        })
        .then(res => res.json())
        .then(data => {
            if (data.success) {
                // Show green success message
                successMessage.textContent = data.message;
                successMessage.classList.remove("d-none");
                successMessage.focus();
                form.reset();

                // Hide after 5 seconds
                setTimeout(() => {
                    successMessage.classList.add("d-none");
                    successMessage.textContent = "";
                }, 5000);
            } else {
                successMessage.textContent = data.error || "Error adding course.";
                successMessage.classList.remove("d-none");
                successMessage.focus();
                successMessage.classList.add("alert-danger");
            }
        })
        .catch(err => {
            successMessage.textContent = "Something went wrong!";
            successMessage.classList.remove("d-none");
            successMessage.focus();
            successMessage.classList.add("alert-danger");
            console.error(err);
        });
    });
});
</script>

{% endblock %}
